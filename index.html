<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MehmetEndüstriyelTakip - Orta Gerilim Hücre Üretim Takip Sistemi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1e40af">
    <link rel="apple-touch-icon" href="assets/icons/icon-192x192.png">
    <script>
        // Service Worker Kaydı
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => {
                        console.log('Service Worker başarıyla kaydedildi:', registration.scope);
                    })
                    .catch(error => {
                        console.error('Service Worker kaydı başarısız:', error);
                    });
            });
        }
    </script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7fa;
        }
        
        .sidebar {
            background-color: var(--primary-color);
            color: white;
            height: 100vh;
            position: fixed;
            padding-top: 20px;
            width: 250px; /* Sabit genişlik eklendi */
        }
        
        .sidebar .nav-link {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 5px;
            border-radius: 5px;
            padding: 10px 15px;
        }
        
        .sidebar .nav-link:hover, .sidebar .nav-link.active {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .sidebar .nav-link i {
            margin-right: 10px;
        }
        
        .main-content {
            margin-left: 250px;
            padding: 20px;
        }
        
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-header {
            background-color: white;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            font-weight: 600;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-planned {
            background-color: #e3f2fd;
            color: #1976d2;
        }
        
        .status-in-progress {
            background-color: #fff8e1;
            color: #ff8f00;
        }
        
        .status-delayed {
            background-color: #ffebee;
            color: #d32f2f;
        }
        
        .status-completed {
            background-color: #e8f5e9;
            color: #388e3c;
        }
        
        .priority-high {
            border-left: 4px solid var(--danger-color);
        }
        
        .priority-medium {
            border-left: 4px solid var(--warning-color);
        }
        
        .priority-low {
            border-left: 4px solid var(--success-color);
        }
        
        .ai-chatbot {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .ai-chatbot-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .ai-chatbot-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--danger-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .progress-thin {
            height: 5px;
        }
        
        .custom-table th {
            background-color: var(--light-color);
            font-weight: 600;
        }
        
        .material-required {
            background-color: #fff3e0;
        }
        
        .material-available {
            background-color: #e8f5e9;
        }
        
        .material-critical {
            background-color: #ffebee;
        }
        
        /* Gantt chart styles */
        .gantt-container {
            font-size: 12px;
        }
        
        .gantt-header {
            font-weight: bold;
        }
        
        .gantt-day {
            border: 1px solid #dee2e6;
            padding: 2px;
        }
        
        .gantt-row {
            height: 30px;
            display: flex;
            align-items: center;
        }
        
        .gantt-bar {
            height: 20px;
            border-radius: 3px;
            position: absolute;
            top: 5px;
        }
        
        /* Chat modal styles */
        .chat-message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 8px;
            max-width: 80%;
        }
        
        .user-message {
            background-color: #e3f2fd;
            margin-left: auto;
        }
        
        .ai-message {
            background-color: #f1f1f1;
            margin-right: auto;
        }
        
        /* Responsive adjustments */
        @media (max-width: 992px) {
            .sidebar {
                width: 220px;
            }
            .main-content {
                margin-left: 220px;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            .main-content {
                margin-left: 0;
            }
        }

        /* Not ve Uyarı Sistemi için Stil Tanımlamaları */
        .notification-pill {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
            position: absolute;
            top: 2px;
            right: 2px;
        }
        
        .notification-yellow {
            background-color: #ffeb3b;
            color: #333;
        }
        
        .notification-red {
            background-color: #f44336;
            color: white;
        }
        
        .notification-counter {
            display: inline-block;
            margin-left: 4px;
            background-color: rgba(0,0,0,0.1);
            padding: 0 4px;
            border-radius: 8px;
            font-size: 9px;
        }
        
        .order-card {
            position: relative;
        }
        
        .alert-note {
            border-left: 4px solid;
            margin-bottom: 10px;
            padding: 10px;
            position: relative;
        }
        
        .alert-note-yellow {
            border-left-color: #ffeb3b;
            background-color: #fffde7;
        }
        
        .alert-note-red {
            border-left-color: #f44336;
            background-color: #ffebee;
        }
        
        .alert-note-success {
            border-left-color: #4caf50;
            background-color: #e8f5e9;
        }
        
        .alert-note .meta {
            font-size: 0.8em;
            color: #666;
            margin-top: 8px;
        }
        
        .alert-note .actions {
            position: absolute;
            right: 10px;
            top: 10px;
        }
        
        .notification-badge.has-alerts {
            animation: pulse 1.5s infinite;
        }
        
        .department-badge {
            font-size: 0.75em;
            font-weight: normal;
            vertical-align: middle;
            margin-left: 5px;
        }
        
        .timer-countdown {
            font-size: 0.8em;
            color: #d32f2f;
            font-weight: bold;
        }
        
        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.2);
            }
            100% {
                transform: scale(1);
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar col-md-3 col-lg-2 d-md-block">
        <div class="text-center mb-4">
            <h4>MehmetEndüstriyelTakip</h4>
            <p class="text-muted small">Orta Gerilim Hücre Üretim Takip</p>
        </div>
        <ul class="nav flex-column">
            <li class="nav-item">
                <a class="nav-link active" href="#dashboard" data-bs-toggle="tab">
                    <i class="bi bi-speedometer2"></i> Genel Bakış
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#orders" data-bs-toggle="tab">
                    <i class="bi bi-file-earmark-text"></i> Siparişler
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#production" data-bs-toggle="tab">
                    <i class="bi bi-gear"></i> Üretim Takip
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#materials" data-bs-toggle="tab">
                    <i class="bi bi-box-seam"></i> Malzeme Yönetimi
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#planning" data-bs-toggle="tab">
                    <i class="bi bi-calendar-check"></i> Planlama
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#reports" data-bs-toggle="tab">
                    <i class="bi bi-graph-up"></i> Raporlar & Analizler
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#technical" data-bs-toggle="tab">
                    <i class="bi bi-file-earmark-code"></i> Teknik Dokümanlar
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#settings" data-bs-toggle="tab">
                    <i class="bi bi-sliders"></i> Ayarlar
                </a>
            </li>
        </ul>
        <div class="mt-auto p-3 text-center text-muted small">
            <p>v1.0.0</p>
            <p>© 2023 MehmetEndüstriyel</p>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="mb-0">Orta Gerilim Hücre Üretim Takip Sistemi</h2>
            <div class="dropdown">
                <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="bi bi-person-circle"></i> Yönetici
                </button>
                <ul class="dropdown-menu" aria-labelledby="userDropdown">
                    <li><a class="dropdown-item" href="#"><i class="bi bi-person"></i> Profil</a></li>
                    <li><a class="dropdown-item" href="#"><i class="bi bi-gear"></i> Ayarlar</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li><a class="dropdown-item" href="#"><i class="bi bi-box-arrow-right"></i> Çıkış Yap</a></li>
                </ul>
            </div>
        </div>

        <div class="tab-content">
            <!-- Dashboard Tab -->
            <div class="tab-pane fade show active" id="dashboard">
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h6 class="text-muted mb-2">Aktif Siparişler</h6>
                                        <h3 class="mb-0">24</h3>
                                    </div>
                                    <div class="bg-primary bg-opacity-10 p-3 rounded">
                                        <i class="bi bi-file-earmark-text text-primary" style="font-size: 1.5rem;"></i>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <span class="text-success"><i class="bi bi-arrow-up"></i> 5.2%</span>
                                    <span class="text-muted">geçen aya göre</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h6 class="text-muted mb-2">Devam Eden Üretim</h6>
                                        <h3 class="mb-0">18</h3>
                                    </div>
                                    <div class="bg-warning bg-opacity-10 p-3 rounded">
                                        <i class="bi bi-gear text-warning" style="font-size: 1.5rem;"></i>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <span class="text-danger"><i class="bi bi-arrow-down"></i> 2.1%</span>
                                    <span class="text-muted">geçen aya göre</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h6 class="text-muted mb-2">Geciken Siparişler</h6>
                                        <h3 class="mb-0">3</h3>
                                    </div>
                                    <div class="bg-danger bg-opacity-10 p-3 rounded">
                                        <i class="bi bi-exclamation-triangle text-danger" style="font-size: 1.5rem;"></i>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <span class="text-success"><i class="bi bi-arrow-down"></i> 1.8%</span>
                                    <span class="text-muted">geçen aya göre</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h6 class="text-muted mb-2">Tamamlanan Siparişler</h6>
                                        <h3 class="mb-0">42</h3>
                                    </div>
                                    <div class="bg-success bg-opacity-10 p-3 rounded">
                                        <i class="bi bi-check-circle text-success" style="font-size: 1.5rem;"></i>
                                    </div>
                                </div>
                                <div class="mt-3">
                                    <span class="text-success"><i class="bi bi-arrow-up"></i> 8.7%</span>
                                    <span class="text-muted">geçen aya göre</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Üretim Durumu</h5>
                                <div class="dropdown">
                                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" id="productionStatusDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        Son 30 Gün
                                    </button>
                                    <ul class="dropdown-menu" aria-labelledby="productionStatusDropdown">
                                        <li><a class="dropdown-item" href="#">Son 7 Gün</a></li>
                                        <li><a class="dropdown-item" href="#">Son 30 Gün</a></li>
                                        <li><a class="dropdown-item" href="#">Son 90 Gün</a></li>
                                        <li><a class="dropdown-item" href="#">Bu Yıl</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="card-body">
                                <canvas id="productionChart" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Hücre Tipi Dağılımı</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="cellTypeChart" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Kritik Malzeme Durumu</h5>
                                <a href="#" class="btn btn-sm btn-outline-primary">Tümünü Gör</a>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Malzeme Kodu</th>
                                                <th>Malzeme Adı</th>
                                                <th>Stok</th>
                                                <th>İhtiyaç</th>
                                                <th>Durum</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr class="material-critical">
                                                <td>137998%</td>
                                                <td>Siemens 7SR1003-1JA20-2DA0+ZY20 24VDC</td>
                                                <td>2</td>
                                                <td>8</td>
                                                <td><span class="badge bg-danger">Kritik</span></td>
                                            </tr>
                                            <tr class="material-required">
                                                <td>144866%</td>
                                                <td>KAP-80/190-95 Akım Trafosu</td>
                                                <td>3</td>
                                                <td>5</td>
                                                <td><span class="badge bg-warning">Eksik</span></td>
                                            </tr>
                                            <tr class="material-required">
                                                <td>120170%</td>
                                                <td>M480TB/G-027-95.300UN5 Kablo Başlığı</td>
                                                <td>12</td>
                                                <td>15</td>
                                                <td><span class="badge bg-warning">Eksik</span></td>
                                            </tr>
                                            <tr class="material-available">
                                                <td>109367%</td>
                                                <td>582mm Bara</td>
                                                <td>25</td>
                                                <td>18</td>
                                                <td><span class="badge bg-success">Yeterli</span></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Son Uyarılar</h5>
                                <div>
                                    <button class="btn btn-sm btn-outline-danger me-2" onclick="showPendingAlerts()">
                                        <i class="bi bi-exclamation-triangle"></i> Yanıt Bekleyenler
                                        <span class="badge bg-danger" id="pendingAlertsCount">3</span>
                                    </button>
                                    <a href="#" class="btn btn-sm btn-outline-primary" onclick="openAllAlertsModal()">Tümünü Gör</a>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="list-group" id="dashboardAlerts">
                                    <a href="#" class="list-group-item list-group-item-action border-danger border-start-0 border-end-0 border-top-0 border-3" onclick="viewAlertDetail('ALT-001')">
                                        <div class="d-flex w-100 justify-content-between">
                                            <h6 class="mb-1">
                                                <span class="notification-pill notification-red">Kritik</span>
                                                Teslim Tarihi Gecikmesi
                                                <span class="badge bg-secondary department-badge">Mekanik Üretim</span>
                                            </h6>
                                            <small class="text-danger">1 saat önce</small>
                                        </div>
                                        <p class="mb-1">Sipariş No: #0424-1251 - RM 36 CB hücresinin mekanik montajı gecikiyor.</p>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <small class="text-muted">Yanıt bekleniyor - <span class="timer-countdown">1:45:22</span> kaldı</small>
                                            <button class="btn btn-sm btn-danger" onclick="respondToAlert('ALT-001', event)">Yanıtla</button>
                                        </div>
                                    </a>
                                    <a href="#" class="list-group-item list-group-item-action border-warning border-start-0 border-end-0 border-top-0 border-3" onclick="viewAlertDetail('ALT-002')">
                                        <div class="d-flex w-100 justify-content-between">
                                            <h6 class="mb-1">
                                                <span class="notification-pill notification-yellow">Önemli</span>
                                                Malzeme Eksikliği
                                                <span class="badge bg-secondary department-badge">Satın Alma</span>
                                            </h6>
                                            <small class="text-warning">3 saat önce</small>
                                        </div>
                                        <p class="mb-1">Sipariş No: #0424-1245 için gerekli akım trafosu stokta yok.</p>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <small class="text-muted">Yanıtlandı - 2 gün içinde tedarik edilecek</small>
                                            <button class="btn btn-sm btn-secondary" onclick="viewAlertResponses('ALT-002', event)">Yanıtlar</button>
                                        </div>
                                    </a>
                                    <a href="#" class="list-group-item list-group-item-action border-success border-start-0 border-end-0 border-top-0 border-3" onclick="viewAlertDetail('ALT-003')">
                                        <div class="d-flex w-100 justify-content-between">
                                            <h6 class="mb-1">
                                                <span class="notification-pill notification-yellow">Önemli</span>
                                                Sorun Çözüldü
                                                <span class="badge bg-secondary department-badge">Kablaj</span>
                                            </h6>
                                            <small class="text-success">5 saat önce</small>
                                        </div>
                                        <p class="mb-1">Sipariş No: #0424-1239 için kablaj problemi çözüldü.</p>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <small class="text-muted">Çözüldü - Kapandı</small>
                                            <button class="btn btn-sm btn-success" onclick="viewAlertResponses('ALT-003', event)">Detay</button>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Orders Tab -->
            <div class="tab-pane fade" id="orders">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Sipariş Yönetimi</h5>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#newOrderModal">
                            <i class="bi bi-plus"></i> Yeni Sipariş Ekle
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <div class="row g-2">
                                <div class="col-md-4">
                                    <input type="text" class="form-control" placeholder="Sipariş No Ara...">
                                </div>
                                <div class="col-md-3">
                                    <select class="form-select">
                                        <option selected>Hücre Tipi Seçin</option>
                                        <option>RM 36 CB</option>
                                        <option>RM 36 LB</option>
                                        <option>RM 36 FL</option>
                                        <option>RMU</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <select class="form-select">
                                        <option selected>Durum Seçin</option>
                                        <option>Planlandı</option>
                                        <option>Devam Ediyor</option>
                                        <option>Gecikmiş</option>
                                        <option>Tamamlandı</option>
                                    </select>
                                </div>
                                <div class="col-md-2">
                                    <button class="btn btn-outline-secondary w-100">Filtrele</button>
                                </div>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-hover custom-table">
                                <thead>
                                    <tr>
                                        <th>Sipariş No</th>
                                        <th>Müşteri</th>
                                        <th>Hücre Tipi</th>
                                        <th>Miktar</th>
                                        <th>Planlanan Teslim</th>
                                        <th>Durum</th>
                                        <th>İlerleme</th>
                                        <th>İşlemler</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="priority-high">
                                        <td>#0424-1251</td>
                                        <td>AYEDAŞ</td>
                                        <td>RM 36 CB</td>
                                        <td>1</td>
                                        <td>15.11.2024</td>
                                        <td><span class="status-badge status-delayed">Gecikiyor</span></td>
                                        <td>
                                            <div class="progress progress-thin">
                                                <div class="progress-bar bg-danger" role="progressbar" style="width: 65%"></div>
                                            </div>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                            <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                        </td>
                                    </tr>
                                    <tr class="priority-medium">
                                        <td>#0424-1245</td>
                                        <td>TEİAŞ</td>
                                        <td>RM 36 CB</td>
                                        <td>1</td>
                                        <td>20.11.2024</td>
                                        <td><span class="status-badge status-in-progress">Devam Ediyor</span></td>
                                        <td>
                                            <div class="progress progress-thin">
                                                <div class="progress-bar bg-warning" role="progressbar" style="width: 45%"></div>
                                            </div>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                            <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>#0424-1239</td>
                                        <td>BEDAŞ</td>
                                        <td>RM 36 LB</td>
                                        <td>1</td>
                                        <td>25.11.2024</td>
                                        <td><span class="status-badge status-in-progress">Devam Ediyor</span></td>
                                        <td>
                                            <div class="progress progress-thin">
                                                <div class="progress-bar bg-warning" role="progressbar" style="width: 30%"></div>
                                            </div>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                            <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>#0424-1235</td>
                                        <td>OSMANİYE ELEKTRİK</td>
                                        <td>RM 36 FL</td>
                                        <td>1</td>
                                        <td>30.11.2024</td>
                                        <td><span class="status-badge status-planned">Planlandı</span></td>
                                        <td>
                                            <div class="progress progress-thin">
                                                <div class="progress-bar bg-info" role="progressbar" style="width: 10%"></div>
                                            </div>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                            <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>#0424-1233</td>
                                        <td>ENERJİSA</td>
                                        <td>RM 36 LB</td>
                                        <td>1</td>
                                        <td>05.12.2024</td>
                                        <td><span class="status-badge status-completed">Tamamlandı</span></td>
                                        <td>
                                            <div class="progress progress-thin">
                                                <div class="progress-bar bg-success" role="progressbar" style="width: 100%"></div>
                                            </div>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button>
                                            <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <nav aria-label="Page navigation">
                            <ul class="pagination justify-content-center">
                                <li class="page-item disabled">
                                    <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Önceki</a>
                                </li>
                                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                <li class="page-item"><a class="page-link" href="#">2</a></li>
                                <li class="page-item"><a class="page-link" href="#">3</a></li>
                                <li class="page-item">
                                    <a class="page-link" href="#">Sonraki</a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>

            <!-- Production Tab -->
            <div class="tab-pane fade" id="production">
                <!-- Görev Yönetimi Kartı - YENİ -->
                <div class="row mb-4">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Günlük Görev Yönetimi</h5>
                                <div>
                                    <button class="btn btn-sm btn-outline-primary" id="refreshTasksBtn">
                                        <i class="bi bi-arrow-clockwise"></i> Yenile
                                    </button>
                                    <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#addTaskModal">
                                        <i class="bi bi-plus"></i> Yeni Görev
                                    </button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="taskStats" class="mb-4">
                                    <!-- İstatistikler buraya gelecek -->
                                </div>
                                <div class="table-responsive">
                                    <table id="taskTable" class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Görev No</th>
                                                <th>Sipariş No</th>
                                                <th>Aşama</th>
                                                <th>Sorumlu</th>
                                                <th>Planlanan Süre</th>
                                                <th>Durum</th>
                                                <th>İlerleme</th>
                                                <th>Gecikme Nedeni</th>
                                                <th>Ek Mesai</th>
                                                <th>İşlemler</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Görev listesi buraya gelecek -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Mevcut üretim takibi ve diğer bölümler -->
                <div class="row">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Üretim Takip Tablosu</h5>
                                <div class="btn-group">
                                    <button class="btn btn-sm btn-outline-secondary">Günlük</button>
                                                <td><span class="badge bg-secondary"><i class="bi bi-dash"></i></span></td>
                                                <td><span class="badge bg-secondary"><i class="bi bi-dash"></i></span></td>
                                            </tr>
                                            <tr>
                                                <td>#0424-1239</td>
                                                <td>RM 36 LB</td>
                                                <td><span class="badge bg-success"><i class="bi bi-check"></i></span></td>
                                                <td><span class="badge bg-success"><i class="bi bi-check"></i></span></td>
                                                <td><span class="badge bg-success"><i class="bi bi-check"></i></span></td>
                                                <td><span class="badge bg-success"><i class="bi bi-check"></i></span></td>
                                                <td><span class="badge bg-secondary"><i class="bi bi-dash"></i></span></td>
                                                <td><span class="badge bg-secondary"><i class="bi bi-dash"></i></span></td>
                                                <td><span class="badge bg-secondary"><i class="bi bi-dash"></i></span></td>
                                                <td><span class="badge bg-secondary"><i class="bi bi-dash"></i></span></td>
                                                <td><span class="badge bg-secondary"><i class="bi bi-dash"></i></span></td>
                                            </tr>
                                            <tr>
                                                <td>#0424-1235</td>
                                                <td>RM 36 FL</td>
                                                <td><span class="badge bg-success"><i class="bi bi-check"></i></span></td>
                                                <td><span class="badge bg-success"><i class="bi bi-check"></i></span></td>
                                                <td><span class="badge bg-warning"><i class="bi bi-exclamation-triangle"></i></span></td>
                                                <td><span class="badge bg-secondary"><i class="bi bi-dash"></i></span></td>
                                                <td><span class="badge bg-secondary"><i class="bi bi-dash"></i></span></td>
                                                <td><span class="badge bg-secondary"><i class="bi bi-dash"></i></span></td>
                                                <td><span class="badge bg-secondary"><i class="bi bi-dash"></i></span></td>
                                                <td><span class="badge bg-secondary"><i class="bi bi-dash"></i></span></td>
                                                <td><span class="badge bg-secondary"><i class="bi bi-dash"></i></span></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Üretim Gantt Şeması</h5>
                            </div>
                            <div class="card-body">
                                <div style="height: 400px; overflow-y: auto;">
                                    <div class="gantt-container">
                                        <div class="gantt-header d-flex mb-2">
                                            <div style="width: 120px;"></div>
                                            <div class="d-flex flex-grow-1">
                                                <div class="gantt-day text-center" style="width: 30px;">Pzt</div>
                                                <div class="gantt-day text-center" style="width: 30px;">Sal</div>
                                                <div class="gantt-day text-center" style="width: 30px;">Çar</div>
                                                <div class="gantt-day text-center" style="width: 30px;">Per</div>
                                                <div class="gantt-day text-center" style="width: 30px;">Cum</div>
                                                <div class="gantt-day text-center" style="width: 30px;">Cmt</div>
                                                <div class="gantt-day text-center" style="width: 30px;">Paz</div>
                                            </div>
                                        </div>
                                        <div class="gantt-row mb-2">
                                            <div style="width: 120px; font-size: 12px;">#0424-1251</div>
                                            <div class="d-flex flex-grow-1 position-relative">
                                                <div class="gantt-bar bg-danger" style="left: 90px; width: 120px;">Mekanik Üretim</div>
                                            </div>
                                        </div>
                                        <div class="gantt-row mb-2">
                                            <div style="width: 120px; font-size: 12px;">#0424-1245</div>
                                            <div class="d-flex flex-grow-1 position-relative">
                                                <div class="gantt-bar bg-warning" style="left: 60px; width: 60px;">Satın Alma</div>
                                            </div>
                                        </div>
                                        <div class="gantt-row mb-2">
                                            <div style="width: 120px; font-size: 12px;">#0424-1239</div>
                                            <div class="d-flex flex-grow-1 position-relative">
                                                <div class="gantt-bar bg-success" style="left: 30px; width: 30px;">Mekanik Tasarım</div>
                                            </div>
                                        </div>
                                        <div class="gantt-row mb-2">
                                            <div style="width: 120px; font-size: 12px;">#0424-1235</div>
                                            <div class="d-flex flex-grow-1 position-relative">
                                                <div class="gantt-bar bg-primary" style="left: 0px; width: 30px;">Elektrik Tasarım</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Birim Bazlı Üretim Takibi</h5>
                                <div class="dropdown">
                                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" id="unitDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        Tüm Birimler
                                    </button>
                                    <ul class="dropdown-menu" aria-labelledby="unitDropdown">
                                        <li><a class="dropdown-item" href="#">Elektrik Tasarım</a></li>
                                        <li><a class="dropdown-item" href="#">Mekanik Tasarım</a></li>
                                        <li><a class="dropdown-item" href="#">Satın Alma</a></li>
                                        <li><a class="dropdown-item" href="#">Mekanik Üretim</a></li>
                                        <li><a class="dropdown-item" href="#">İç Montaj</a></li>
                                        <li><a class="dropdown-item" href="#">Kablaj</a></li>
                                        <li><a class="dropdown-item" href="#">Genel Montaj</a></li>
                                        <li><a class="dropdown-item" href="#">Test</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="card mb-3">
                                            <div class="card-body text-center">
                                                <h6 class="card-title">Elektrik Tasarım</h6>
                                                <div class="d-flex justify-content-between align-items-center mt-3">
                                                    <div>
                                                        <h3 class="mb-0">4</h3>
                                                        <small class="text-muted">Toplam İş</small>
                                                    </div>
                                                    <div>
                                                        <h3 class="mb-0">2</h3>
                                                        <small class="text-muted">Devam Eden</small>
                                                    </div>
                                                    <div>
                                                        <h3 class="mb-0">2</h3>
                                                        <small class="text-muted">Tamamlanan</small>
                                                    </div>
                                                </div>
                                                <div class="progress mt-3">
                                                    <div class="progress-bar bg-success" role="progressbar" style="width: 50%"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="card mb-3">
                                            <div class="card-body text-center">
                                                <h6 class="card-title">Mekanik Tasarım</h6>
                                                <div class="d-flex justify-content-between align-items-center mt-3">
                                                    <div>
                                                        <h3 class="mb-0">4</h3>
                                                        <small class="text-muted">Toplam İş</small>
                                                    </div>
                                                    <div>
                                                        <h3 class="mb-0">1</h3>
                                                        <small class="text-muted">Devam Eden</small>
                                                    </div>
                                                    <div>
                                                        <h3 class="mb-0">3</h3>
                                                        <small class="text-muted">Tamamlanan</small>
                                                    </div>
                                                </div>
                                                <div class="progress mt-3">
                                                    <div class="progress-bar bg-success" role="progressbar" style="width: 75%"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="card mb-3">
                                            <div class="card-body text-center">
                                                <h6 class="card-title">Satın Alma</h6>
                                                <div class="d-flex justify-content-between align-items-center mt-3">
                                                    <div>
                                                        <h3 class="mb-0">4</h3>
                                                        <small class="text-muted">Toplam İş</small>
                                                    </div>
                                                    <div>
                                                        <h3 class="mb-0">1</h3>
                                                        <small class="text-muted">Devam Eden</small>
                                                    </div>
                                                    <div>
                                                        <h3 class="mb-0">3</h3>
                                                        <small class="text-muted">Tamamlanan</small>
                                                    </div>
                                                </div>
                                                <div class="progress mt-3">
                                                    <div class="progress-bar bg-warning" role="progressbar" style="width: 75%"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="card mb-3">
                                            <div class="card-body text-center">
                                                <h6 class="card-title">Mekanik Üretim</h6>
                                                <div class="d-flex justify-content-between align-items-center mt-3">
                                                    <div>
                                                        <h3 class="mb-0">4</h3>
                                                        <small class="text-muted">Toplam İş</small>
                                                    </div>
                                                    <div>
                                                        <h3 class="mb-0">1</h3>
                                                        <small class="text-muted">Devam Eden</small>
                                                    </div>
                                                    <div>
                                                        <h3 class="mb-0">3</h3>
                                                        <small class="text-muted">Tamamlanan</small>
                                                    </div>
                                                </div>
                                                <div class="progress mt-3">
                                                    <div class="progress-bar bg-danger" role="progressbar" style="width: 25%"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Materials Tab -->
            <div class="tab-pane fade" id="materials">
                <div class="row">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Malzeme Yönetimi</h5>
                                <div class="btn-group">
                                    <button class="btn btn-sm btn-outline-secondary">Tümü</button>
                                    <button class="btn btn-sm btn-outline-secondary">Stokta Olanlar</button>
                                    <button class="btn btn-sm btn-outline-secondary active">Kritik Stok</button>
                                    <button class="btn btn-sm btn-outline-secondary">Sipariş Bekleyenler</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Malzeme Kodu</th>
                                                <th>Malzeme Adı</th>
                                                <th>Stok Miktarı</th>
                                                <th>Minimum Stok</th>
                                                <th>Tedarik Süresi</th>
                                                <th>Son Sipariş Tarihi</th>
                                                <th>Durum</th>
                                                <th>İşlemler</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr class="material-critical">
                                                <td>137998%</td>
                                                <td>Siemens 7SR1003-1JA20-2DA0+ZY20 24VDC</td>
                                                <td>2</td>
                                                <td>5</td>
                                                <td>15 gün</td>
                                                <td>10.10.2024</td>
                                                <td><span class="badge bg-danger">Kritik</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-primary">Sipariş Ekle</button>
                                                </td>
                                            </tr>
                                            <tr class="material-required">
                                                <td>144866%</td>
                                                <td>KAP-80/190-95 Akım Trafosu</td>
                                                <td>3</td>
                                                <td>5</td>
                                                <td>10 gün</td>
                                                <td>15.10.2024</td>
                                                <td><span class="badge bg-warning">Düşük</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-primary">Sipariş Ekle</button>
                                                </td>
                                            </tr>
                                            <tr class="material-required">
                                                <td>120170%</td>
                                                <td>M480TB/G-027-95.300UN5 Kablo Başlığı</td>
                                                <td>12</td>
                                                <td>15</td>
                                                <td>7 gün</td>
                                                <td>20.10.2024</td>
                                                <td><span class="badge bg-warning">Düşük</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-primary">Sipariş Ekle</button>
                                                </td>
                                            </tr>
                                            <tr class="material-available">
                                                <td>109367%</td>
                                                <td>582mm Bara</td>
                                                <td>25</td>
                                                <td>10</td>
                                                <td>5 gün</td>
                                                <td>05.10.2024</td>
                                                <td><span class="badge bg-success">Yeterli</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-secondary">Detay</button>
                                                </td>
                                            </tr>
                                            <tr class="material-available">
                                                <td>109363%</td>
                                                <td>432mm Bara</td>
                                                <td>18</td>
                                                <td>10</td>
                                                <td>5 gün</td>
                                                <td>05.10.2024</td>
                                                <td><span class="badge bg-success">Yeterli</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-secondary">Detay</button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Malzeme Tahminleri</h5>
                            </div>
                            <div class="card-body">
                                <canvas id="materialForecastChart" height="300"></canvas>
                            </div>
                        </div>
                        <div class="card mt-4">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Son Siparişler</h5>
                                <a href="#" class="btn btn-sm btn-outline-primary">Tümü</a>
                            </div>
                            <div class="card-body">
                                <div class="list-group">
                                    <a href="#" class="list-group-item list-group-item-action">
                                        <div class="d-flex w-100 justify-content-between">
                                            <h6 class="mb-1">#PO-2024-1025</h6>
                                            <small class="text-muted">2 gün önce</small>
                                        </div>
                                        <p class="mb-1">Siemens 7SR1003-1JA20-2DA0+ZY20 24VDC</p>
                                        <small class="text-muted">Miktar: 5, Tahmini Teslim: 25.11.2024</small>
                                    </a>
                                    <a href="#" class="list-group-item list-group-item-action">
                                        <div class="d-flex w-100 justify-content-between">
                                            <h6 class="mb-1">#PO-2024-1024</h6>
                                            <small class="text-muted">5 gün önce</small>
                                        </div>
                                        <p class="mb-1">KAP-80/190-95 Akım Trafosu</p>
                                        <small class="text-muted">Miktar: 3, Tahmini Teslim: 20.11.2024</small>
                                    </a>
                                    <a href="#" class="list-group-item list-group-item-action">
                                        <div class="d-flex w-100 justify-content-between">
                                            <h6 class="mb-1">#PO-2024-1023</h6>
                                            <small class="text-muted">1 hafta önce</small>
                                        </div>
                                        <p class="mb-1">M480TB/G-027-95.300UN5 Kablo Başlığı</p>
                                        <small class="text-muted">Miktar: 10, Tahmini Teslim: 15.11.2024</small>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Planning Tab -->
            <div class="tab-pane fade" id="planning">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Üretim Planlama</h5>
                                <div class="btn-group">
                                    <button class="btn btn-sm btn-outline-secondary">Günlük</button>
                                    <button class="btn btn-sm btn-outline-secondary active">Haftalık</button>
                                    <button class="btn btn-sm btn-outline-secondary">Aylık</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="productionCalendar"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Kapasite Planlama</h5>
                                <div class="dropdown">
                                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" id="capacityDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        Tüm Birimler
                                    </button>
                                    <ul class="dropdown-menu" aria-labelledby="capacityDropdown">
                                        <li><a class="dropdown-item" href="#">Elektrik Tasarım</a></li>
                                        <li><a class="dropdown-item" href="#">Mekanik Tasarım</a></li>
                                        <li><a class="dropdown-item" href="#">Satın Alma</a></li>
                                        <li><a class="dropdown-item" href="#">Mekanik Üretim</a></li>
                                        <li><a class="dropdown-item" href="#">İç Montaj</a></li>
                                        <li><a class="dropdown-item" href="#">Kablaj</a></li>
                                        <li><a class="dropdown-item" href="#">Genel Montaj</a></li>
                                        <li><a class="dropdown-item" href="#">Test</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="card-body">
                                <canvas id="capacityChart" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Teslimat Tahminleri</h5>
                                <div class="dropdown">
                                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" id="deliveryDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        Son 30 Gün
                                    </button>
                                    <ul class="dropdown-menu" aria-labelledby="deliveryDropdown">
                                        <li><a class="dropdown-item" href="#">Son 7 Gün</a></li>
                                        <li><a class="dropdown-item" href="#">Son 30 Gün</a></li>
                                        <li><a class="dropdown-item" href="#">Son 90 Gün</a></li>
                                        <li><a class="dropdown-item" href="#">Bu Yıl</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="card-body">
                                <canvas id="deliveryChart" height="300"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reports Tab -->
            <div class="tab-pane fade" id="reports">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Raporlar ve Analizler</h5>
                                <div class="dropdown">
                                    <button class="btn btn-primary dropdown-toggle" type="button" id="reportsDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        <i class="bi bi-download"></i> Rapor Al
                                    </button>
                                    <ul class="dropdown-menu" aria-labelledby="reportsDropdown">
                                        <li><a class="dropdown-item" href="#">Üretim Raporu</a></li>
                                        <li><a class="dropdown-item" href="#">Malzeme Raporu</a></li>
                                        <li><a class="dropdown-item" href="#">Gecikme Raporu</a></li>
                                        <li><a class="dropdown-item" href="#">Verimlilik Raporu</a></li>
                                        <li><hr class="dropdown-divider"></li>
                                        <li><a class="dropdown-item" href="#">Özel Rapor Oluştur</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="card mb-4">
                                            <div class="card-header">
                                                <h6 class="mb-0">Üretim Verimliliği</h6>
                                            </div>
                                            <div class="card-body">
                                                <canvas id="efficiencyChart" height="250"></canvas>
                                            </div>
                                        </div>
                                        <div class="card">
                                            <div class="card-header">
                                                <h6 class="mb-0">Gecikme Nedenleri</h6>
                                            </div>
                                            <div class="card-body">
                                                <canvas id="delayChart" height="250"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card mb-4">
                                            <div class="card-header">
                                                <h6 class="mb-0">Birim Bazlı Çalışma Süreleri</h6>
                                            </div>
                                            <div class="card-body">
                                                <canvas id="unitTimeChart" height="250"></canvas>
                                            </div>
                                        </div>
                                        <div class="card">
                                            <div class="card-header">
                                                <h6 class="mb-0">Müşteri Bazlı Siparişler</h6>
                                            </div>
                                            <div class="card-body">
                                                <canvas id="customerChart" height="250"></canvas>
                                            </div>
                                        </div>
                                        <div class="card">
                                            <div class="card-header">
                                                <h6 class="mb-0">Uyarı Çözüm Analizi</h6>
                                            </div>
                                            <div class="card-body">
                                                <canvas id="alertResolutionChart" height="250"></canvas>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Uyarı ve Çözüm Takip Analizi</h5>
                                <div class="btn-group">
                                    <button class="btn btn-sm btn-outline-secondary active">Son 30 Gün</button>
                                    <button class="btn btn-sm btn-outline-secondary">Son 90 Gün</button>
                                    <button class="btn btn-sm btn-outline-secondary">Tüm Zamanlar</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Birim</th>
                                                <th>Toplam Uyarı</th>
                                                <th>Çözülen</th>
                                                <th>Çözüm Süresi (Ort.)</th>
                                                <th>Çözüm Oranı</th>
                                                <th>Tekrarlayan Sorunlar</th>
                                                <th>Performans</th>
                                            </tr>
                                        </thead>
                                        <tbody id="departmentAnalyticsTable">
                                            <tr>
                                                <td>Mekanik Üretim</td>
                                                <td>15</td>
                                                <td>12</td>
                                                <td>4.2 saat</td>
                                                <td>80%</td>
                                                <td>3</td>
                                                <td>
                                                    <div class="progress" style="height: 8px;">
                                                        <div class="progress-bar bg-success" role="progressbar" style="width: 80%"></div>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Satın Alma</td>
                                                <td>12</td>
                                                <td>10</td>
                                                <td>6.8 saat</td>
                                                <td>83%</td>
                                                <td>1</td>
                                                <td>
                                                    <div class="progress" style="height: 8px;">
                                                        <div class="progress-bar bg-success" role="progressbar" style="width: 83%"></div>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Kablaj</td>
                                                <td>8</td>
                                                <td>8</td>
                                                <td>2.1 saat</td>
                                                <td>100%</td>
                                                <td>0</td>
                                                <td>
                                                    <div class="progress" style="height: 8px;">
                                                        <div class="progress-bar bg-success" role="progressbar" style="width: 100%"></div>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Technical Tab -->
            <div class="tab-pane fade" id="technical">
                <div class="row">
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Teknik Dokümanlar</h5>
                                <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#uploadDocumentModal">
                                    <i class="bi bi-upload"></i> Yükle
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="input-group mb-3">
                                    <input type="text" class="form-control" placeholder="Doküman ara...">
                                    <button class="btn btn-outline-secondary" type="button">
                                        <i class="bi bi-search"></i>
                                    </button>
                                </div>
                                <div class="list-group">
                                    <a href="#" class="list-group-item list-group-item-action">
                                        <div class="d-flex w-100 justify-content-between">
                                            <h6 class="mb-1">RM 36 CB Teknik Çizim</h6>
                                            <small class="text-muted">15.10.2024</small>
                                        </div>
                                        <p class="mb-1">Rev. 2.1 - Son güncelleme: Ahmet Yılmaz</p>
                                        <small class="text-muted">Elektrik Tasarım</small>
                                    </a>
                                    <a href="#" class="list-group-item list-group-item-action">
                                        <div class="d-flex w-100 justify-content-between">
                                            <h6 class="mb-1">RM 36 LB Montaj Talimatı</h6>
                                            <small class="text-muted">10.10.2024</small>
                                        </div>
                                        <p class="mb-1">Rev. 1.3 - Son güncelleme: Mehmet Demir</p>
                                        <small class="text-muted">Mekanik Tasarım</small>
                                    </a>
                                    <a href="#" class="list-group-item list-group-item-action">
                                        <div class="d-flex w-100 justify-content-between">
                                            <h6 class="mb-1">RM 36 FL Test Prosedürü</h6>
                                            <small class="text-muted">05.10.2024</small>
                                        </div>
                                        <p class="mb-1">Rev. 3.0 - Son güncelleme: Ayşe Kaya</p>
                                        <small class="text-muted">Test Birimi</small>
                                    </a>
                                    <a href="#" class="list-group-item list-group-item-action">
                                        <div class="d-flex w-100 justify-content-between">
                                            <h6 class="mb-1">RMU Kablaj Şeması</h6>
                                            <small class="text-muted">01.10.2024</small>
                                        </div>
                                        <p class="mb-1">Rev. 1.5 - Son güncelleme: Fatma Şahin</p>
                                        <small class="text-muted">Kablaj Birimi</small>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Teknik Sorgulama</h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label for="technicalQuestion" class="form-label">Teknik sorunuzu yazın:</label>
                                    <textarea class="form-control" id="technicalQuestion" rows="3" placeholder="Örneğin: RM 36 CB hücresinde hangi akım trafosu kullanılır?"></textarea>
                                </div>
                                <button class="btn btn-primary">Sorgula</button>
                                <hr>
                                <div class="alert alert-info">
                                    <h6><i class="bi bi-lightbulb"></i> Yapay Zeka Cevabı:</h6>
                                    <p>RM 36 CB hücresinde genellikle 200-400/5-5A 5P20 7,5/15VA veya 300-600/5-5A 5P20 7,5/15VA özelliklerinde toroidal tip akım trafoları kullanılmaktadır. Canias kodları: 144866% (KAP-80/190-95) veya 142227% (KAT-85/190-95).</p>
                                    <p class="mb-0">Referans doküman: <a href="#">RM 36 CB Teknik Şartnamesi Rev.2.1</a></p>
                                </div>
                                <div class="mt-3">
                                    <h6>İlgili Dokümanlar:</h6>
                                    <ul>
                                        <li><a href="#">RM 36 CB Teknik Çizim</a> - Rev.2.1</li>
                                        <li><a href="#">Akım Trafosu Seçim Kılavuzu</a> - Rev.1.3</li>
                                        <li><a href="#">TEDAS-MLZ-2020-069 Teknik Şartname</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-pane fade" id="settings">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Sistem Ayarları</h5>
                            </div>
                            <div class="card-body">
                                <form>
                                    <div class="mb-3">
                                        <label for="companyName" class="form-label">Şirket Adı</label>
                                        <input type="text" class="form-control" id="companyName" value="Mehmet Endüstriyel">
                                    </div>
                                    <div class="mb-3">
                                        <label for="timezone" class="form-label">Zaman Dilimi</label>
                                        <select class="form-select" id="timezone">
                                            <option selected>(UTC+03:00) İstanbul</option>
                                            <option>(UTC+01:00) Berlin</option>
                                            <option>(UTC+00:00) Londra</option>
                                            <option>(UTC-05:00) New York</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label for="dateFormat" class="form-label">Tarih Formatı</label>
                                        <select class="form-select" id="dateFormat">
                                            <option selected>DD.MM.YYYY (24.11.2024)</option>
                                            <option>MM/DD/YYYY (11/24/2024)</option>
                                            <option>YYYY-MM-DD (2024-11-24)</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">ERP Entegrasyonu</label>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="erpIntegration" checked>
                                            <label class="form-check-label" for="erpIntegration">
                                                Canias ERP ile entegrasyon aktif
                                            </label>
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-primary">Ayarları Kaydet</button>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Kullanıcı Yönetimi</h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Ad Soyad</th>
                                                <th>Departman</th>
                                                <th>Rol</th>
                                                <th>Durum</th>
                                                <th>İşlem</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Ahmet Yılmaz</td>
                                                <td>Elektrik Tasarım</td>
                                                <td>Yönetici</td>
                                                <td><span class="badge bg-success">Aktif</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Mehmet Demir</td>
                                                <td>Mekanik Tasarım</td>
                                                <td>Kullanıcı</td>
                                                <td><span class="badge bg-success">Aktif</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Ayşe Kaya</td>
                                                <td>Test</td>
                                                <td>Kullanıcı</td>
                                                <td><span class="badge bg-success">Aktif</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Fatma Şahin</td>
                                                <td>Kablaj</td>
                                                <td>Kullanıcı</td>
                                                <td><span class="badge bg-secondary">Pasif</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <button class="btn btn-primary mt-3" data-bs-toggle="modal" data-bs-target="#addUserModal">
                                    <i class="bi bi-plus"></i> Yeni Kullanıcı Ekle
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Yapay Zeka Ayarları</h5>
                            </div>
                            <div class="card-body">
                                <form>
                                    <div class="mb-3">
                                        <label class="form-label">Yapay Zeka Modülleri</label>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="aiProduction" checked>
                                            <label class="form-check-label" for="aiProduction">
                                                Üretim Tahmini Modülü
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="aiMaterial" checked>
                                            <label class="form-check-label" for="aiMaterial">
                                                Malzeme Tahmini Modülü
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="aiTechnical" checked>
                                            <label class="form-check-label" for="aiTechnical">
                                                Teknik Destek Modülü
                                            </label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="aiAnalysis">
                                            <label class="form-check-label" for="aiAnalysis">
                                                Analiz Modülü (Deneysel)
                                            </label>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label for="aiModel" class="form-label">Model Seçimi</label>
                                        <select class="form-select" id="aiModel">
                                            <option selected>GPT-4 (OpenAI)</option>
                                            <option>GPT-3.5 Turbo (OpenAI)</option>
                                            <option>DeepSeek (Yerel Model)</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label for="apiKey" class="form-label">API Anahtarı</label>
                                        <input type="password" class="form-control" id="apiKey" placeholder="sk-...">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Eğitim Verileri</label>
                                        <div class="form-text mb-2">Sistemin öğrenmesi için teknik dokümanları yükleyin:</div>
                                        <input type="file" class="form-control" multiple>
                                    </div>
                                    <button type="submit" class="btn btn-primary">Ayarları Kaydet</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Chatbot -->
    <div class="ai-chatbot">
        <div class="ai-chatbot-btn" id="ai-chatbot-btn">
            <i class="bi bi-robot"></i>
            <span class="notification-badge">3</span>
        </div>
    </div>

    <!-- New Order Modal -->
    <div class="modal fade" id="newOrderModal" tabindex="-1" aria-labelledby="newOrderModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="newOrderModalLabel">Yeni Sipariş Ekle</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="orderNumber" class="form-label">Sipariş No</label>
                                <input type="text" class="form-control" id="orderNumber" value="AUTO-GENERATED" readonly>
                            </div>
                            <div class="col-md-6">
                                <label for="orderDate" class="form-label">Sipariş Tarihi</label>
                                <input type="date" class="form-control" id="orderDate">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="customer" class="form-label">Müşteri</label>
                                <select class="form-select" id="customer">
                                    <option selected>Seçiniz</option>
                                    <option>AYEDAŞ</option>
                                    <option>BEDAŞ</option>
                                    <option>TEİAŞ</option>
                                    <option>ENERJİSA</option>
                                    <option>OSMANİYE ELEKTRİK</option>
                                    <option>DİĞER</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="projectNumber" class="form-label">Proje No</label>
                                <input type="text" class="form-control" id="projectNumber">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="deliveryDate" class="form-label">Planlanan Teslim Tarihi</label>
                                <input type="date" class="form-control" id="deliveryDate">
                            </div>
                            <div class="col-md-6">
                                <label for="incoterm" class="form-label">Teslim Şekli (Incoterm)</label>
                                <select class="form-select" id="incoterm">
                                    <option selected>Seçiniz</option>
                                    <option>Nakliye Dahil, İndirme Hariç</option>
                                    <option>FCA - Fabrika Teslim</option>
                                    <option>FOB - Gemi Bordasında Teslim</option>
                                    <option>CIF - Mal Bedeli, Sigorta ve Navlun Ödenmiş Olarak Teslim</option>
                                </select>
                            </div>
                        </div>
                        <hr>
                        <h5 class="mb-3">Hücre Bilgileri</h5>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="cellType" class="form-label">Hücre Tipi</label>
                                <select class="form-select" id="cellType">
                                    <option selected>Seçiniz</option>
                                    <option>RM 36 CB</option>
                                    <option>RM 36 LB</option>
                                    <option>RM 36 FL</option>
                                    <option>RMU</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="quantity" class="form-label">Miktar</label>
                                <input type="number" class="form-control" id="quantity" min="1" value="1">
                            </div>
                            <div class="col-md-4">
                                <label for="cellCode" class="form-label">Hücre Kodu</label>
                                <input type="text" class="form-control" id="cellCode">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="voltage" class="form-label">Çalışma Gerilimi</label>
                                <select class="form-select" id="voltage">
                                    <option selected>36kV</option>
                                    <option>24kV</option>
                                    <option>12kV</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="current" class="form-label">Nominal Çalışma Akımı</label>
                                <select class="form-select" id="current">
                                    <option selected>630A</option>
                                    <option>1250A</option>
                                    <option>2000A</option>
                                    <option>4000A</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="shortCircuit" class="form-label">Kısa Devre Akımı</label>
                                <select class="form-select" id="shortCircuit">
                                    <option selected>16kA</option>
                                    <option>20kA</option>
                                    <option>25kA</option>
                                    <option>31.5kA</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="controlVoltage" class="form-label">Kontrol Gerilimi</label>
                                <select class="form-select" id="controlVoltage">
                                    <option selected>24 VDC</option>
                                    <option>48 VDC</option>
                                    <option>110 VDC</option>
                                    <option>220 VAC</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="cellDescription" class="form-label">Teknik Değer ve Ürün Tanımı</label>
                            <textarea class="form-control" id="cellDescription" rows="2"></textarea>
                        </div>
                        <hr>
                        <h5 class="mb-3">Ekipman Seçimleri</h5>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="currentTransformer" class="form-label">Akım Trafosu</label>
                                <select class="form-select" id="currentTransformer">
                                    <option selected>Seçiniz</option>
                                    <option>200-400/5-5A 5P20 7,5/15VA</option>
                                    <option>300-600/5-5A 5P20 7,5/15VA</option>
                                    <option>400-800/5-5A 5P20 7,5/15VA</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="voltageTransformer" class="form-label">Gerilim Trafosu (Canias Kodu)</label>
                                <input type="text" class="form-control" id="voltageTransformer">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="breakerMotor" class="form-label">Kesici Motor Bobin</label>
                                <input type="text" class="form-control" id="breakerMotor" value="24 VDC">
                            </div>
                            <div class="col-md-6">
                                <label for="disconnectorMotor" class="form-label">Ayırıcı Motor Bobin</label>
                                <input type="text" class="form-control" id="disconnectorMotor" value="24 VDC">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="relay" class="form-label">Röle (Canias Kodu)</label>
                                <input type="text" class="form-control" id="relay" value="137998%">
                            </div>
                            <div class="col-md-6">
                                <label for="energyAnalyzer" class="form-label">Enerji Analizörü (Canias Kodu)</label>
                                <input type="text" class="form-control" id="energyAnalyzer">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="surgeArrester" class="form-label">AGD</label>
                                <input type="text" class="form-control" id="surgeArrester" value="OVI+S (10nf)">
                            </div>
                            <div class="col-md-6">
                                <label for="meter" class="form-label">Sayaç (Canias Kodu)</label>
                                <input type="text" class="form-control" id="meter">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="fuse" class="form-label">YG Sigorta (Marka, Tip)</label>
                                <input type="text" class="form-control" id="fuse">
                            </div>
                            <div class="col-md-6">
                                <label for="voltageIndicator" class="form-label">Gerilim Gösterge Tipi</label>
                                <input type="text" class="form-control" id="voltageIndicator">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="dcSupply" class="form-label">DC Besleme Grubu</label>
                                <input type="text" class="form-control" id="dcSupply">
                            </div>
                            <div class="col-md-6">
                                <label for="cableHead" class="form-label">Kablo Başlığı (Canias Kodu)</label>
                                <input type="text" class="form-control" id="cableHead" value="120170%">
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="busbar" class="form-label">Diziliş Bara (Canias Kodu)</label>
                                <input type="text" class="form-control" id="busbar" value="109367%">
                            </div>
                            <div class="col-md-6">
                                <label for="closureDetail" class="form-label">Kapama Detayı</label>
                                <input type="text" class="form-control" id="closureDetail">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="otherFeatures" class="form-label">Diğer Özellikler</label>
                            <textarea class="form-control" id="otherFeatures" rows="2" placeholder="Örneğin: *Motorlu *Kablo başlıkları Euromold marka. *UKD 10 m."></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Özel Tasarım Gerekli Mi?</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="customDesign" id="customDesignNo" checked>
                                <label class="form-check-label" for="customDesignNo">
                                    Gerekli değil
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="customDesign" id="customDesignYes">
                                <label class="form-check-label" for="customDesignYes">
                                    Gerekli
                                </label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Kilitleme Çalışması Gerekli Mi?</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="lockingWork" id="lockingWorkNo" checked>
                                <label class="form-check-label" for="lockingWorkNo">
                                    Gerekli değil
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="lockingWork" id="lockingWorkYes">
                                <label class="form-check-label" for="lockingWorkYes">
                                    Gerekli
                                </label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Etiket ve Dil Bilgileri</label>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="standardTurkish" checked>
                                <label class="form-check-label" for="standardTurkish">
                                    Standart Türkçe
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="energysaStandard">
                                <label class="form-check-label" for="energysaStandard">
                                    Standart EnerjiSA RM + RMU (RM36CB'nin ayırıcılarında sayıcı olacak.)
                                </label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="referenceDocuments" class="form-label">Referans Doküman No</label>
                            <textarea class="form-control" id="referenceDocuments" rows="2" placeholder="Örneğin: *TEDAŞ-MLZ/95-002.D *EnerjiSA güncel ek şartnameleri"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="comments" class="form-label">Yorumlar</label>
                            <textarea class="form-control" id="comments" rows="2"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
                    <button type="button" class="btn btn-primary">Siparişi Kaydet</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Upload Document Modal -->
    <div class="modal fade" id="uploadDocumentModal" tabindex="-1" aria-labelledby="uploadDocumentModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="uploadDocumentModalLabel">Teknik Doküman Yükle</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label for="documentName" class="form-label">Doküman Adı</label>
                            <input type="text" class="form-control" id="documentName">
                        </div>
                        <div class="mb-3">
                            <label for="documentType" class="form-label">Doküman Türü</label>
                            <select class="form-select" id="documentType">
                                <option selected>Seçiniz</option>
                                <option>Teknik Çizim</option>
                                <option>Montaj Talimatı</option>
                                <option>Test Prosedürü</option>
                                <option>Teknik Şartname</option>
                                <option>Diğer</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="documentDepartment" class="form-label">İlgili Birim</label>
                            <select class="form-select" id="documentDepartment">
                                <option selected>Seçiniz</option>
                                <option>Elektrik Tasarım</option>
                                <option>Mekanik Tasarım</option>
                                <option>Satın Alma</option>
                                <option>Mekanik Üretim</option>
                                <option>İç Montaj</option>
                                <option>Kablaj</option>
                                <option>Genel Montaj</option>
                                <option>Test</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="documentRevision" class="form-label">Revizyon No</label>
                            <input type="text" class="form-control" id="documentRevision" placeholder="Örneğin: 1.0">
                        </div>
                        <div class="mb-3">
                            <label for="documentFile" class="form-label">Dosya Seçin</label>
                            <input class="form-control" type="file" id="documentFile">
                        </div>
                        <div class="mb-3">
                            <label for="documentDescription" class="form-label">Açıklama</label>
                            <textarea class="form-control" id="documentDescription" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
                    <button type="button" class="btn btn-primary">Yükle</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add User Modal -->
    <div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addUserModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addUserModalLabel">Yeni Kullanıcı Ekle</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label for="userName" class="form-label">Ad Soyad</label>
                            <input type="text" class="form-control" id="userName">
                        </div>
                        <div class="mb-3">
                            <label for="userEmail" class="form-label">E-posta</label>
                            <input type="email" class="form-control" id="userEmail">
                        </div>
                        <div class="mb-3">
                            <label for="userDepartment" class="form-label">Departman</label>
                            <select class="form-select" id="userDepartment">
                                <option selected>Seçiniz</option>
                                <option>Satış</option>
                                <option>Proje Yönetimi</option>
                                <option>Elektrik Tasarım</option>
                                <option>Mekanik Tasarım</option>
                                <option>Satın Alma</option>
                                <option>Mekanik Üretim</option>
                                <option>İç Montaj</option>
                                <option>Kablaj</option>
                                <option>Genel Montaj</option>
                                <option>Test</option>
                                <option>Yönetim</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="userRole" class="form-label">Rol</label>
                            <select class="form-select" id="userRole">
                                <option selected>Kullanıcı</option>
                                <option>Yönetici</option>
                                <option>Süper Yönetici</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="userPassword" class="form-label">Şifre</label>
                            <input type="password" class="form-control" id="userPassword">
                        </div>
                        <div class="mb-3">
                            <label for="userPasswordConfirm" class="form-label">Şifre Tekrar</label>
                            <input type="password" class="form-control" id="userPasswordConfirm">
                        </div>
                        <div class="mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="userActive" checked>
                                <label class="form-check-label" for="userActive">
                                    Kullanıcı aktif
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
                    <button type="button" class="btn btn-primary">Kullanıcı Ekle</button>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Chatbot Modal -->
    <div class="modal fade" id="aiChatModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">Yapay Zeka Asistan</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" style="height: 400px; overflow-y: auto;">
                    <div id="chatMessages"></div>
                </div>
                <div class="modal-footer">
                    <div class="input-group">
                        <input type="text" id="aiChatInput" class="form-control" placeholder="Soru sorun...">
                        <button class="btn btn-primary" id="sendChatBtn">Gönder</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Not ve Uyarı Sistemi Modalleri -->
    <div class="modal fade" id="alertDetailModal" tabindex="-1" aria-labelledby="alertDetailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="alertDetailModalLabel">Uyarı Detayı</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert-detail-container">
                        <div class="alert" id="alertDetailContent">
                            <!-- Uyarı detayları buraya JavaScript ile eklenecek -->
                        </div>
                        
                        <div class="alert-note-header mt-4 mb-2">
                            <h6>Yanıtlar ve Takip</h6>
                        </div>
                        
                        <div id="alertResponsesContainer">
                            <!-- Yanıtlar buraya JavaScript ile eklenecek -->
                        </div>
                    </div>
                    
                    <hr>
                    
                    <div class="alert-response-form mt-3" id="alertResponseForm">
                        <h6>Yanıt Ekle</h6>
                        <form id="addResponseForm">
                            <div class="mb-3">
                                <label for="responseType" class="form-label">Yanıt Tipi</label>
                                <select class="form-select" id="responseType">
                                    <option value="solved">Sorun Çözüldü</option>
                                    <option value="in-progress">Üzerinde Çalışılıyor</option>
                                    <option value="delayed">Ertelendi (Nedeni Belirtin)</option>
                                    <option value="reassign">Başka Birime Aktarılmalı</option>
                                    <option value="needs-info">Daha Fazla Bilgi Gerekli</option>
                                    <option value="cant-solve">Çözülemiyor (Yönetim Kararı Gerekli)</option>
                                </select>
                            </div>
                            <div class="mb-3" id="delayTimeContainer" style="display:none;">
                                <label for="delayTime" class="form-label">Erteleme Süresi</label>
                                <select class="form-select" id="delayTime">
                                    <option value="1">1 Gün</option>
                                    <option value="2">2 Gün</option>
                                    <option value="3">3 Gün</option>
                                    <option value="5">5 Gün</option>
                                    <option value="7">1 Hafta</option>
                                    <option value="14">2 Hafta</option>
                                </select>
                            </div>
                            <div class="mb-3" id="reassignDepartmentContainer" style="display:none;">
                                <label for="reassignDepartment" class="form-label">Sorumlu Birim</label>
                                <select class="form-select" id="reassignDepartment">
                                    <option value="sales">Satış</option>
                                    <option value="design-electrical">Elektrik Tasarım</option>
                                    <option value="design-mechanical">Mekanik Tasarım</option>
                                    <option value="purchasing">Satın Alma</option>
                                    <option value="production-mechanical">Mekanik Üretim</option>
                                    <option value="production-assembly">Montaj</option>
                                    <option value="production-wiring">Kablaj</option>
                                    <option value="quality">Kalite Kontrol</option>
                                    <option value="testing">Test</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="responseComment" class="form-label">Açıklama</label>
                                <textarea class="form-control" id="responseComment" rows="3" placeholder="Yanıtınızla ilgili detayları yazın..."></textarea>
                            </div>
                            <button type="button" class="btn btn-primary" id="submitAlertResponse">Yanıtı Gönder</button>
                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Tüm Uyarılar Modalı -->
    <div class="modal fade" id="allAlertsModal" tabindex="-1" aria-labelledby="allAlertsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="allAlertsModalLabel">Tüm Uyarılar</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert-filters mb-3">
                        <div class="row">
                            <div class="col-md-3">
                                <select class="form-select" id="alertTypeFilter">
                                    <option value="all" selected>Tüm Uyarı Tipleri</option>
                                    <option value="red">Kritik Uyarılar</option>
                                    <option value="yellow">Önemli Uyarılar</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <select class="form-select" id="alertStatusFilter">
                                    <option value="all" selected>Tüm Durumlar</option>
                                    <option value="pending">Yanıt Bekleyenler</option>
                                    <option value="inprogress">Çözüm Sürecindekiler</option>
                                    <option value="resolved">Çözülenler</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <select class="form-select" id="departmentFilter">
                                    <option value="all" selected>Tüm Birimler</option>
                                    <option value="sales">Satış</option>
                                    <option value="design-electrical">Elektrik Tasarım</option>
                                    <option value="design-mechanical">Mekanik Tasarım</option>
                                    <option value="purchasing">Satın Alma</option>
                                    <option value="production-mechanical">Mekanik Üretim</option>
                                    <option value="production-assembly">Montaj</option>
                                    <option value="production-wiring">Kablaj</option>
                                    <option value="quality">Kalite Kontrol</option>
                                    <option value="testing">Test</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <button class="btn btn-primary w-100" id="applyAlertFilters">Filtrele</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="table-responsive">
                        <table class="table table-hover" id="allAlertsTable">
                            <thead>
                                <tr>
                                    <th>Uyarı ID</th>
                                    <th>Sipariş No</th>
                                    <th>Öncelik</th>
                                    <th>Konu</th>
                                    <th>Birim</th>
                                    <th>Oluşturulma</th>
                                    <th>Durum</th>
                                    <th>Kalan Süre</th>
                                    <th>İşlemler</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Uyarı listesi JavaScript ile doldurulacak -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="exportAlerts">
                        <i class="bi bi-download"></i> Dışa Aktar
                    </button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Yeni Uyarı Oluşturma Modalı -->
    <div class="modal fade" id="createAlertModal" tabindex="-1" aria-labelledby="createAlertModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="createAlertModalLabel">Yeni Uyarı/Not Oluştur</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="createAlertForm">
                        <input type="hidden" id="alertOrderId" value="">
                        
                        <div class="mb-3">
                            <label for="alertTitle" class="form-label">Konu</label>
                            <input type="text" class="form-control" id="alertTitle" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="alertDescription" class="form-label">Açıklama</label>
                            <textarea class="form-control" id="alertDescription" rows="3" required></textarea>
                        </div>
                        
                        <div class="mb-3">
                            <label for="alertPriority" class="form-label">Öncelik Seviyesi</label>
                            <select class="form-select" id="alertPriority" required>
                                <option value="yellow">Önemli (Sarı)</option>
                                <option value="red">Kritik (Kırmızı)</option>
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label for="alertDepartment" class="form-label">Sorumlu Birim</label>
                            <select class="form-select" id="alertDepartment" required>
                                <option value="" selected disabled>Birim seçin...</option>
                                <option value="sales">Satış</option>
                                <option value="design-electrical">Elektrik Tasarım</option>
                                <option value="design-mechanical">Mekanik Tasarım</option>
                                <option value="purchasing">Satın Alma</option>
                                <option value="production-mechanical">Mekanik Üretim</option>
                                <option value="production-assembly">Montaj</option>
                                <option value="production-wiring">Kablaj</option>
                                <option value="quality">Kalite Kontrol</option>
                                <option value="testing">Test</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">İptal</button>
                    <button type="button" class="btn btn-primary" id="saveAlertBtn">Uyarıyı Kaydet</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.9/index.global.min.js" crossorigin="anonymous"></script>
    
    <!-- Config -->
    <script src="config/app-config.js"></script>
    
    <!-- Core Utilities -->
    <script src="core/logger.js"></script>
    <script src="utils/event-bus.js"></script>
    
    <!-- Services -->
    <script src="services/api-service.js"></script>
    <script src="services/erp-service.js"></script>
    <script src="services/ai-service.js"></script>
    
    <!-- Core -->
    <script src="core/compat-check.js"></script>
    <script src="core/firebase-config.js"></script>
    <script src="core/mock-firebase.js"></script>
    
    <!-- AI Modules -->
    <script src="modules/ai/advanced-ai.js"></script>
    <script src="modules/ai/chatbot.js"></script>
    <script src="modules/ai/ai-analytics.js"></script>
    <script src="modules/ai/ai-integration.js"></script>
    
    <!-- App Modules -->
    <script src="modules/dashboard/dashboard.js"></script>
    <script src="modules/orders/orders.js"></script>
    <script src="modules/production/production.js"></script>
    
    <!-- App Core -->
    <script src="core/app.js"></script>
    <script src="core/main.js"></script>
    
    <!-- Not ve Uyarı Sistemi JS -->
    <script>
        // Uyarı Sistemi Veritabanı (LocalStorage'da saklanacak)
        let alertsDB = {
            alerts: [
                {
                    id: "ALT-001",
                    orderId: "#0424-1251",
                    title: "Teslim Tarihi Gecikmesi",
                    description: "RM 36 CB hücresinin mekanik montajı gecikiyor. Akım trafosu montajında uyumsuzluk tespit edildi.",
                    priority: "red",
                    department: "production-mechanical",
                    departmentName: "Mekanik Üretim",
                    createdBy: "Ahmet Yılmaz",
                    createdAt: new Date(Date.now() - 3600000).toISOString(), // 1 saat önce
                    status: "pending",
                    deadline: new Date(Date.now() + 6600000).toISOString(), // 3 saat - geçen 1 saat = 2 saat 50 dk
                    responses: []
                },
                {
                    id: "ALT-002",
                    orderId: "#0424-1245",
                    title: "Malzeme Eksikliği",
                    description: "Sipariş için gerekli akım trafosu stokta yok. İvedi sipariş gerekiyor.",
                    priority: "yellow",
                    department: "purchasing",
                    departmentName: "Satın Alma",
                    createdBy: "Mehmet Demir",
                    createdAt: new Date(Date.now() - 10800000).toISOString(), // 3 saat önce
                    status: "in-progress",
                    deadline: new Date(Date.now() - 100000).toISOString(), // Süresi geçmiş
                    responses: [
                        {
                            id: "RSP-001",
                            alertId: "ALT-002",
                            responseType: "in-progress", 
                            comment: "Sipariş açıldı, tedarikçi ile görüşüldü. 2 gün içinde teslim edilecek.",
                            respondedBy: "Ayşe Kaya",
                            respondedAt: new Date(Date.now() - 9000000).toISOString(),
                            department: "purchasing"
                        }
                    ]
                },
                {
                    id: "ALT-003",
                    orderId: "#0424-1239",
                    title: "Sorun Çözüldü",
                    description: "Kablaj problemi tespit edildi ve çözüldü.",
                    priority: "yellow",
                    department: "production-wiring",
                    departmentName: "Kablaj",
                    createdBy: "Fatma Şahin",
                    createdAt: new Date(Date.now() - 18000000).toISOString(), // 5 saat önce
                    status: "resolved",
                    deadline: new Date(Date.now() - 7200000).toISOString(),
                    responses: [
                        {
                            id: "RSP-002",
                            alertId: "ALT-003",
                            responseType: "solved",
                            comment: "Problem tespit edildi, kablo değiştirilerek sorun çözüldü.",
                            respondedBy: "Hasan Yılmaz",
                            respondedAt: new Date(Date.now() - 16200000).toISOString(),
                            department: "production-wiring"
                        }
                    ]
                }
            ]
        };

        // LocalStorage'dan verileri yükle
        function loadAlertsFromStorage() {
            const savedAlerts = localStorage.getItem('mehmetet_alerts');
            if (savedAlerts) {
                alertsDB = JSON.parse(savedAlerts);
            }
        }

        // Verileri LocalStorage'a kaydet
        function saveAlertsToStorage() {
            localStorage.setItem('mehmetet_alerts', JSON.stringify(alertsDB));
        }

        // Sayfa yüklendiğinde
        document.addEventListener('DOMContentLoaded', function() {
            // LocalStorage'dan uyarıları yükle
            loadAlertsFromStorage();
            
            // Dashboard uyarılarını göster
            updateDashboardAlerts();
            
            // Bekleyen uyarı sayısını güncelle
            updatePendingAlertsCount();
            
            // Yanıt tipi değiştiğinde ilgili alanları göster/gizle
            document.getElementById('responseType').addEventListener('change', function() {
                const selectedType = this.value;
                
                // Tümünü gizle
                document.getElementById('delayTimeContainer').style.display = 'none';
                document.getElementById('reassignDepartmentContainer').style.display = 'none';
                
                // Seçime göre göster
                if (selectedType === 'delayed') {
                    document.getElementById('delayTimeContainer').style.display = 'block';
                }
                
                if (selectedType === 'reassign') {
                    document.getElementById('reassignDepartmentContainer').style.display = 'block';
                }
            });
            
            // Uyarı yanıtı gönderme butonuna tıklandığında
            document.getElementById('submitAlertResponse').addEventListener('click', function() {
                submitAlertResponse();
            });
            
            // Filtrele butonuna tıklandığında
            document.getElementById('applyAlertFilters').addEventListener('click', function() {
                filterAlerts();
            });
            
            // Yeni uyarı kaydetme butonuna tıklandığında
            document.getElementById('saveAlertBtn').addEventListener('click', function() {
                saveNewAlert();
            });
            
            // 1 dakikada bir süreleri güncelle
            setInterval(updateCountdowns, 60000);
            
            // İlk kez sayfa açıldığında süreleri güncelle
            updateCountdowns();
            
            // Birim bazlı analiz grafiğini oluştur
            renderDepartmentAnalysisChart();
        });

        // Uyarı detaylarını göster
        function viewAlertDetail(alertId, event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            const alert = alertsDB.alerts.find(a => a.id === alertId);
            if (!alert) return;
            
            const alertDetailContent = document.getElementById('alertDetailContent');
            const alertResponsesContainer = document.getElementById('alertResponsesContainer');
            
            // Uyarı detaylarını göster
            alertDetailContent.className = `alert ${alert.priority === 'red' ? 'alert-danger' : 'alert-warning'}`;
            alertDetailContent.innerHTML = `
                <h5>${alert.title} <span class="badge ${alert.priority === 'red' ? 'bg-danger' : 'bg-warning'}">${alert.priority === 'red' ? 'Kritik' : 'Önemli'}</span></h5>
                <p>${alert.description}</p>
                <div class="d-flex justify-content-between">
                    <small>Sipariş: ${alert.orderId}</small>
                    <small>Oluşturan: ${alert.createdBy}</small>
                    <small>Tarih: ${formatDate(alert.createdAt)}</small>
                </div>
                <div class="mt-2">
                    <span class="badge bg-secondary">${alert.departmentName}</span>
                    <span class="badge ${getStatusBadgeClass(alert.status)}">${getStatusText(alert.status)}</span>
                </div>
            `;
            
            // Yanıtları göster
            alertResponsesContainer.innerHTML = '';
            if (alert.responses && alert.responses.length > 0) {
                alert.responses.forEach(response => {
                    alertResponsesContainer.innerHTML += createResponseHtml(response);
                });
            } else {
                alertResponsesContainer.innerHTML = '<div class="alert alert-light">Henüz yanıt yok.</div>';
            }
            
            // Yanıt formunu göster veya gizle
            const responseForm = document.getElementById('alertResponseForm');
            if (alert.status === 'resolved') {
                responseForm.style.display = 'none';
            } else {
                responseForm.style.display = 'block';
                // Form submit işlevini ayarla
                document.getElementById('submitAlertResponse').onclick = function() {
                    submitAlertResponse(alertId);
                };
            }
            
            // Modal'ı göster
            const modal = new bootstrap.Modal(document.getElementById('alertDetailModal'));
            modal.show();
        }

        // Uyarı yanıtlarını göster
        function viewAlertResponses(alertId, event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            viewAlertDetail(alertId);
        }

        // Uyarıya yanıt ver modalını aç
        function respondToAlert(alertId, event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            viewAlertDetail(alertId);
            
            // Form alanına odaklan
            setTimeout(() => {
                document.getElementById('responseComment').focus();
            }, 500);
        }

        // Tüm uyarılar modalını aç
        function openAllAlertsModal() {
            const allAlertsTable = document.getElementById('allAlertsTable').querySelector('tbody');
            allAlertsTable.innerHTML = '';
            
            // Tüm uyarıları ekle
            alertsDB.alerts.forEach(alert => {
                const row = document.createElement('tr');
                
                // Öncelik sınıfı ekle
                if (alert.priority === 'red') {
                    row.classList.add('table-danger');
                } else if (alert.priority === 'yellow') {
                    row.classList.add('table-warning');
                }
                
                row.innerHTML = `
                    <td>${alert.id}</td>
                    <td>${alert.orderId}</td>
                    <td>
                        <span class="badge ${alert.priority === 'red' ? 'bg-danger' : 'bg-warning'}">
                            ${alert.priority === 'red' ? 'Kritik' : 'Önemli'}
                        </span>
                    </td>
                    <td>${alert.title}</td>
                    <td>${alert.departmentName}</td>
                    <td>${formatDateShort(alert.createdAt)}</td>
                    <td>
                        <span class="badge ${getStatusBadgeClass(alert.status)}">
                            ${getStatusText(alert.status)}
                        </span>
                    </td>
                    <td>${getRemainingTimeText(alert)}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="viewAlertDetail('${alert.id}')">
                            <i class="bi bi-eye"></i>
                        </button>
                        ${alert.status !== 'resolved' ? 
                            `<button class="btn btn-sm btn-outline-success ms-1" onclick="respondToAlert('${alert.id}')">
                                <i class="bi bi-reply"></i>
                            </button>` : ''}
                    </td>
                `;
                
                allAlertsTable.appendChild(row);
            });
            
            // Modal'ı göster
            const modal = new bootstrap.Modal(document.getElementById('allAlertsModal'));
            modal.show();
        }

        // Bekleyen uyarıları göster
        function showPendingAlerts() {
            // Tüm uyarılar modalını aç
            openAllAlertsModal();
            
            // Bekleyen uyarıları filtrele
            document.getElementById('alertStatusFilter').value = 'pending';
            filterAlerts();
        }

        // Uyarıları filtrele
        function filterAlerts() {
            const typeFilter = document.getElementById('alertTypeFilter').value;
            const statusFilter = document.getElementById('alertStatusFilter').value;
            const departmentFilter = document.getElementById('departmentFilter').value;
            
            const rows = document.getElementById('allAlertsTable').querySelectorAll('tbody tr');
            
            rows.forEach(row => {
                const alertId = row.cells[0].textContent;
                const alert = alertsDB.alerts.find(a => a.id === alertId);
                
                if (!alert) return;
                
                let showRow = true;
                
                // Tip filtreleme
                if (typeFilter !== 'all' && alert.priority !== typeFilter) {
                    showRow = false;
                }
                
                // Durum filtreleme
                if (statusFilter !== 'all' && alert.status !== statusFilter) {
                    showRow = false;
                }
                
                // Departman filtreleme
                if (departmentFilter !== 'all' && alert.department !== departmentFilter) {
                    showRow = false;
                }
                
                // Satırı göster veya gizle
                row.style.display = showRow ? '' : 'none';
            });
        }

        // Uyarı yanıtı gönder
        function submitAlertResponse(alertId) {
            const currentAlert = alertsDB.alerts.find(a => a.id === alertId);
            if (!currentAlert) return;
            
            const responseType = document.getElementById('responseType').value;
            const comment = document.getElementById('responseComment').value;
            
            if (!comment) {
                alert('Lütfen bir açıklama yazın.');
                return;
            }
            
            // Ek alanları kontrol et
            let additionalData = {};
            
            if (responseType === 'delayed') {
                additionalData.delayTime = document.getElementById('delayTime').value;
            }
            
            if (responseType === 'reassign') {
                additionalData.reassignDepartment = document.getElementById('reassignDepartment').value;
                additionalData.reassignDepartmentName = document.getElementById('reassignDepartment').options[
                    document.getElementById('reassignDepartment').selectedIndex
                ].text;
            }
            
            // Yeni yanıt oluştur
            const newResponse = {
                id: `RSP-${Date.now()}`,
                alertId: currentAlert.id,
                responseType: responseType,
                comment: comment,
                respondedBy: "Aktif Kullanıcı", // Gerçek uygulamada oturum açan kullanıcı
                respondedAt: new Date().toISOString(),
                department: "current-department", // Gerçek uygulamada kullanıcının departmanı
                additionalData: additionalData
            };
            
            // Uyarının durumunu güncelle
            let newStatus = currentAlert.status;
            
            switch (responseType) {
                case 'solved':
                    newStatus = 'resolved';
                    break;
                case 'in-progress':
                case 'delayed':
                case 'needs-info':
                    newStatus = 'in-progress';
                    break;
                case 'reassign':
                    // Departman değişimi
                    currentAlert.department = additionalData.reassignDepartment;
                    currentAlert.departmentName = additionalData.reassignDepartmentName;
                    // Yeni departman için yeni süre başlat
                    currentAlert.deadline = new Date(Date.now() + 3 * 60 * 60 * 1000).toISOString(); // 3 saat
                    newStatus = 'pending';
                    break;
                case 'cant-solve':
                    newStatus = 'escalated';
                    break;
            }
            
            currentAlert.status = newStatus;
            
            // Yanıtı ekle
            if (!currentAlert.responses) currentAlert.responses = [];
            currentAlert.responses.push(newResponse);
            
            // Verileri kaydet
            saveAlertsToStorage();
            
            // UI güncelle
            updateDashboardAlerts();
            updatePendingAlertsCount();
            
            // Yanıt formunu temizle
            document.getElementById('responseComment').value = '';
            
            // Modal'ı kapat ve detay modalını yenile
            viewAlertDetail(alertId);
            
            // Bildirim göster
            showNetworkStatusNotification('Yanıtınız kaydedildi', 'success');
        }

        // Yeni uyarı oluştur
        function createNewAlert(orderId) {
            // Form alanlarını temizle
            document.getElementById('alertTitle').value = '';
            document.getElementById('alertDescription').value = '';
            document.getElementById('alertPriority').value = 'yellow';
            document.getElementById('alertDepartment').value = '';
            
            // Sipariş ID'sini ayarla
            document.getElementById('alertOrderId').value = orderId;
            
            // Modal'ı göster
            const modal = new bootstrap.Modal(document.getElementById('createAlertModal'));
            modal.show();
        }

        // Yeni uyarıyı kaydet
        function saveNewAlert() {
            const title = document.getElementById('alertTitle').value;
            const description = document.getElementById('alertDescription').value;
            const priority = document.getElementById('alertPriority').value;
            const department = document.getElementById('alertDepartment').value;
            const orderId = document.getElementById('alertOrderId').value;
            
            if (!title || !description || !department || !orderId) {
                alert('Lütfen tüm alanları doldurun.');
                return;
            }
            
            // Departman adını al
            const departmentName = document.getElementById('alertDepartment').options[
                document.getElementById('alertDepartment').selectedIndex
            ].text;
            
            // Yeni uyarı oluştur
            const newAlert = {
                id: `ALT-${Date.now()}`,
                orderId: orderId,
                title: title,
                description: description,
                priority: priority,
                department: department,
                departmentName: departmentName,
                createdBy: "Aktif Kullanıcı", // Gerçek uygulamada oturum açan kullanıcı
                createdAt: new Date().toISOString(),
                status: "pending",
                deadline: new Date(Date.now() + 3 * 60 * 60 * 1000).toISOString(), // 3 saat
                responses: []
            };
            
            // Uyarıyı ekle
            alertsDB.alerts.push(newAlert);
            
            // Verileri kaydet
            saveAlertsToStorage();
            
            // UI güncelle
            updateDashboardAlerts();
            updatePendingAlertsCount();
            
            // İlgili siparişin kartına uyarı işareti ekle
            addAlertBadgeToOrder(orderId, priority);
            
            // Modal'ı kapat
            const modal = bootstrap.Modal.getInstance(document.getElementById('createAlertModal'));
            modal.hide();
            
            // Bildirim göster
            showNetworkStatusNotification('Yeni uyarı oluşturuldu', 'success');
        }

        // Siparişe uyarı rozeti ekle
        function addAlertBadgeToOrder(orderId, priority) {
            const orderCards = document.querySelectorAll(`[data-order-id="${orderId}"]`);
            orderCards.forEach(card => {
                // Mevcut rozeti kontrol et
                let badge = card.querySelector('.notification-pill');
                if (!badge) {
                    // Yoksa yeni rozet ekle
                    badge = document.createElement('span');
                    badge.classList.add('notification-pill');
                    card.appendChild(badge);
                }
                
                // Rozeti güncelle
                badge.className = `notification-pill notification-${priority}`;
                
                // Bu sipariş için toplam uyarı sayısını hesapla
                const orderAlerts = alertsDB.alerts.filter(alert => alert.orderId === orderId);
                
                // Sayıyı rozete ekle
                if (orderAlerts.length > 1) {
                    badge.innerHTML = `<span class="notification-counter">${orderAlerts.length}</span>`;
                }
            });
        }

        // Bekleyen uyarı sayısını güncelle
        function updatePendingAlertsCount() {
            const pendingAlerts = alertsDB.alerts.filter(alert => 
                alert.status === 'pending' || (alert.status === 'in-progress' && new Date(alert.deadline) < new Date())
            );
            
            const countElement = document.getElementById('pendingAlertsCount');
            if (countElement) {
                countElement.textContent = pendingAlerts.length;
                
                // Eğer bekleyen uyarı varsa animasyon ekle
                if (pendingAlerts.length > 0) {
                    document.querySelectorAll('.notification-badge').forEach(badge => {
                        badge.classList.add('has-alerts');
                    });
                } else {
                    document.querySelectorAll('.notification-badge').forEach(badge => {
                        badge.classList.remove('has-alerts');
                    });
                }
            }
        }

        // Dashboard uyarılarını güncelle
        function updateDashboardAlerts() {
            const container = document.getElementById('dashboardAlerts');
            if (!container) return;
            
            // En son 3 uyarıyı al
            const recentAlerts = [...alertsDB.alerts]
                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                .slice(0, 3);
            
            container.innerHTML = '';
            
            recentAlerts.forEach(alert => {
                let statusHtml;
                
                if (alert.status === 'pending') {
                    const remainingTime = getRemainingTimeText(alert);
                    statusHtml = `
                        <small class="text-muted">Yanıt bekleniyor - <span class="timer-countdown">${remainingTime}</span> kaldı</small>
                        <button class="btn btn-sm btn-danger" onclick="respondToAlert('${alert.id}', event)">Yanıtla</button>
                    `;
                } else if (alert.status === 'in-progress') {
                    // Son yanıtı göster
                    const latestResponse = alert.responses[alert.responses.length - 1];
                    statusHtml = `
                        <small class="text-muted">Yanıtlandı - ${getResponseSummary(latestResponse)}</small>
                        <button class="btn btn-sm btn-secondary" onclick="viewAlertResponses('${alert.id}', event)">Yanıtlar</button>
                    `;
                } else if (alert.status === 'resolved') {
                    statusHtml = `
                        <small class="text-muted">Çözüldü - Kapandı</small>
                        <button class="btn btn-sm btn-success" onclick="viewAlertResponses('${alert.id}', event)">Detay</button>
                    `;
                }
                
                const alertHtml = `
                    <a href="#" class="list-group-item list-group-item-action border-${getStatusColor(alert)} border-start-0 border-end-0 border-top-0 border-3" onclick="viewAlertDetail('${alert.id}', event)">
                        <div class="d-flex w-100 justify-content-between">
                            <h6 class="mb-1">
                                <span class="notification-pill notification-${alert.priority}">${alert.priority === 'red' ? 'Kritik' : 'Önemli'}</span>
                                ${alert.title}
                                <span class="badge bg-secondary department-badge">${alert.departmentName}</span>
                            </h6>
                            <small class="text-${getStatusColor(alert)}">${formatTimeAgo(alert.createdAt)}</small>
                        </div>
                        <p class="mb-1">Sipariş No: ${alert.orderId} - ${alert.description}</p>
                        <div class="d-flex justify-content-between align-items-center">
                            ${statusHtml}
                        </div>
                    </a>
                `;
                
                container.innerHTML += alertHtml;
            });
        }

        // Tüm süreleri güncelle
        function updateCountdowns() {
            const countdownElements = document.querySelectorAll('.timer-countdown');
            
            countdownElements.forEach(element => {
                // İlgili uyarıyı bul
                const alertItem = element.closest('.list-group-item');
                if (!alertItem) return;
                
                const alertId = alertItem.getAttribute('onclick').split("'")[1];
                const alert = alertsDB.alerts.find(a => a.id === alertId);
                
                if (!alert) return;
                
                // Süreyi güncelle
                element.textContent = getRemainingTimeText(alert);
                
                // Süre geçtiyse uyarı ekle
                if (new Date(alert.deadline) < new Date()) {
                    element.style.color = '#d32f2f';
                    element.innerHTML = `<i class="bi bi-alarm"></i> ${element.textContent}`;
                }
            });
        }

        // Yanıt HTML'i oluştur
        function createResponseHtml(response) {
            const responseTypeClass = getResponseTypeClass(response.responseType);
            const responseTypeText = getResponseTypeText(response.responseType);
            
            let additionalInfoHtml = '';
            
            if (response.additionalData) {
                if (response.additionalData.delayTime) {
                    additionalInfoHtml = `<div class="alert alert-warning py-1 px-2 mt-1 mb-0">
                        <small><i class="bi bi-hourglass-split"></i> ${response.additionalData.delayTime} gün ertelendi</small>
                    </div>`;
                }
                
                if (response.additionalData.reassignDepartment) {
                    additionalInfoHtml = `<div class="alert alert-info py-1 px-2 mt-1 mb-0">
                        <small><i class="bi bi-arrow-right-circle"></i> ${response.additionalData.reassignDepartmentName} birimine aktarıldı</small>
                    </div>`;
                }
            }
            
            return `
                <div class="alert-note ${responseTypeClass} mb-3">
                    <div class="alert-note-header d-flex justify-content-between">
                        <span class="badge ${getResponseTypeBadgeClass(response.responseType)}">${responseTypeText}</span>
                        <small>${formatDateShort(response.respondedAt)}</small>
                    </div>
                    <p class="mt-2 mb-1">${response.comment}</p>
                    ${additionalInfoHtml}
                    <div class="meta">
                        <small>Yanıtlayan: ${response.respondedBy}</small>
                    </div>
                </div>
            `;
        }

        // Yardımcı Fonksiyonlar
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleString('tr-TR');
        }
        
        function formatDateShort(dateString) {
            const date = new Date(dateString);
            return date.toLocaleString('tr-TR', { 
                day: '2-digit', 
                month: '2-digit', 
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        function formatTimeAgo(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diff = Math.floor((now - date) / 1000); // saniye cinsinden fark
            
            if (diff < 60) return 'Az önce';
            if (diff < 3600) return `${Math.floor(diff / 60)} dakika önce`;
            if (diff < 86400) return `${Math.floor(diff / 3600)} saat önce`;
            return `${Math.floor(diff / 86400)} gün önce`;
        }
        
        function getRemainingTimeText(alert) {
            if (!alert.deadline) return '';
            
            const deadline = new Date(alert.deadline);
            const now = new Date();
            
            // Eğer süre geçtiyse
            if (deadline < now) {
                const diff = Math.floor((now - deadline) / 1000); // saniye cinsinden fark
                if (diff < 3600) return `${Math.floor(diff / 60)} dk gecikmiş`;
                if (diff < 86400) return `${Math.floor(diff / 3600)} saat gecikmiş`;
                return `${Math.floor(diff / 86400)} gün gecikmiş`;
            }
            
            // Kalan süre
            const diff = Math.floor((deadline - now) / 1000);
            const hours = Math.floor(diff / 3600);
            const minutes = Math.floor((diff % 3600) / 60);
            
            return `${hours}:${minutes.toString().padStart(2, '0')}`;
        }
        
        function getStatusText(status) {
            switch (status) {
                case 'pending': return 'Yanıt Bekliyor';
                case 'in-progress': return 'Çözülüyor';
                case 'resolved': return 'Çözüldü';
                case 'escalated': return 'Yönetim Kararı';
                default: return 'Bilinmeyen';
            }
        }
        
        function getStatusBadgeClass(status) {
            switch (status) {
                case 'pending': return 'bg-danger';
                case 'in-progress': return 'bg-warning';
                case 'resolved': return 'bg-success';
                case 'escalated': return 'bg-info';
                default: return 'bg-secondary';
            }
        }
        
        function getStatusColor(alert) {
            switch (alert.status) {
                case 'pending': return 'danger';
                case 'in-progress': return 'warning';
                case 'resolved': return 'success';
                case 'escalated': return 'info';
                default: return 'secondary';
            }
        }
        
        function getResponseTypeClass(type) {
            switch (type) {
                case 'solved': return 'alert-note-success';
                case 'in-progress': 
                case 'needs-info': return 'alert-note-yellow';
                case 'delayed':
                case 'reassign':  
                case 'cant-solve': return 'alert-note-red';
                default: return 'alert-note-yellow';
            }
        }
        
        function getResponseTypeBadgeClass(type) {
            switch (type) {
                case 'solved': return 'bg-success';
                case 'in-progress': return 'bg-primary';
                case 'needs-info': return 'bg-info';
                case 'delayed': return 'bg-warning';
                case 'reassign': return 'bg-secondary';
                case 'cant-solve': return 'bg-danger';
                default: return 'bg-secondary';
            }
        }
        
        function getResponseTypeText(type) {
            switch (type) {
                case 'solved': return 'Çözüldü';
                case 'in-progress': return 'Üzerinde Çalışılıyor';
                case 'needs-info': return 'Bilgi Gerekli';
                case 'delayed': return 'Ertelendi';
                case 'reassign': return 'Başka Birime Aktarıldı';
                case 'cant-solve': return 'Çözülemiyor';
                default: return type;
            }
        }
        
        function getResponseSummary(response) {
            if (!response) return '';
            
            switch (response.responseType) {
                case 'solved': return 'Çözüldü';
                case 'in-progress': return 'Üzerinde çalışılıyor';
                case 'needs-info': return 'Daha fazla bilgi gerekli';
                case 'delayed': 
                    return response.additionalData?.delayTime ? 
                        `${response.additionalData.delayTime} gün içinde çözülecek` : 
                        'Ertelendi';
                case 'reassign': 
                    return response.additionalData?.reassignDepartmentName ?
                        `${response.additionalData.reassignDepartmentName} birimine aktarıldı` :
                        'Başka birime aktarıldı';
                case 'cant-solve': return 'Yönetim kararı gerekiyor';
                default: return response.comment.substring(0, 30) + '...';
            }
        }

        // Birim bazlı analiz grafiği
        function renderDepartmentAnalysisChart() {
            const ctx = document.getElementById('alertResolutionChart');
            if (!ctx) return;
            
            // Analiz verilerini hesapla
            const departments = ['Mekanik Üretim', 'Satın Alma', 'Kablaj', 'Elektrik Tasarım', 'Mekanik Tasarım'];
            const responseTime = [4.2, 6.8, 2.1, 3.5, 5.2]; // saat cinsinden
            const resolutionRate = [80, 83, 100, 92, 75]; // yüzde cinsinden
            const recurringIssues = [3, 1, 0, 2, 4]; // adet cinsinden
            
            // Grafiği oluştur
            if (typeof Chart !== 'undefined') {
                try {
                    new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: departments,
                            datasets: [
                                {
                                    label: 'Ortalama Çözüm Süresi (saat)',
                                    data: responseTime,
                                    backgroundColor: 'rgba(54, 162, 235, 0.7)',
                                    borderColor: 'rgb(54, 162, 235)',
                                    borderWidth: 1,
                                    yAxisID: 'y'
                                },
                                {
                                    label: 'Çözüm Oranı (%)',
                                    data: resolutionRate,
                                    backgroundColor: 'rgba(75, 192, 192, 0.7)',
                                    borderColor: 'rgb(75, 192, 192)',
                                    borderWidth: 1,
                                    yAxisID: 'y1'
                                },
                                {
                                    label: 'Tekrarlayan Sorunlar (adet)',
                                    data: recurringIssues,
                                    backgroundColor: 'rgba(255, 99, 132, 0.7)',
                                    borderColor: 'rgb(255, 99, 132)',
                                    borderWidth: 1,
                                    yAxisID: 'y'
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    position: 'left',
                                    title: {
                                        display: true,
                                        text: 'Saat / Adet'
                                    }
                                },
                                y1: {
                                    beginAtZero: true,
                                    max: 100,
                                    position: 'right',
                                    title: {
                                        display: true,
                                        text: 'Yüzde (%)'
                                    },
                                    grid: {
                                        drawOnChartArea: false
                                    }
                                }
                            },
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'Birim Bazlı Uyarı Analizi'
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            let label = context.dataset.label || '';
                                            if (label) {
                                                label += ': ';
                                            }
                                            if (context.dataset.yAxisID === 'y1') {
                                                label += context.raw + '%';
                                            } else {
                                                label += context.raw;
                                            }
                                            return label;
                                        }
                                    }
                                }
                            }
                        }
                    });
                } catch (error) {
                    console.error('Uyarı analiz grafiği oluşturulurken hata:', error);
                }
            }
        }
    </script>
</body>
</html>